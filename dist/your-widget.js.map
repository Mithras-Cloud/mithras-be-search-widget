{"version":3,"sources":["../src/core/format.ts","../src/core/state.ts","../src/wc.ts"],"names":["DEFAULT_GROUP","GROUP_SEPARATOR","CHILD_SEPARATOR","safeInt","value","fallback","parsed","safeFloat","parseGroupsForm","input","segment","roomsRaw","rest","adultsRaw","childrenRaw","infantsRaw","childrenAges","age","formatGroupsForm","groups","group","children","summarizeGuests","acc","cloneGroups","ISO_DATE_PATTERN","todayIso","now","addDays","iso","days","date","ensureIsoDate","DEFAULT_LOCALE","DEFAULT_CURRENCY","DEFAULT_POS","DEFAULT_PRODUCT_ID","createInitialState","config","_a","_b","_c","_d","baseStart","baseEnd","startDate","endDate","parsedGroups","validateDateRange","start","end","validateGroups","index","validateState","state","errors","dateError","groupError","buildSearchPayload","groups_form","STYLE_TEXT","observed","booleanAttr","host","name","toNumber","mapGroupToMarkup","renderGroups","parseChildren","defaultConfig","token","YourWidgetElement","_e","_f","_g","_h","event","type","payload","detail","next","theme","pos","locale","currency","productId","isSearching","redirect","summary","errorMessage","root","form","registerInput","selector","handler","redirectInput","target","field","button","_","idx","addButton","validation","response","data","error","err","registerYourWidget"],"mappings":"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","file":"your-widget.js","sourcesContent":["import { GroupSpec } from './types';\n\nexport const DEFAULT_GROUP: GroupSpec = {\n  rooms: 1,\n  adults: 2,\n  childrenAges: [],\n  infants: 0,\n};\n\nconst GROUP_SEPARATOR = ';';\nconst CHILD_SEPARATOR = '.';\n\nconst safeInt = (value: string, fallback = 0) => {\n  const parsed = Number.parseInt(value, 10);\n  return Number.isFinite(parsed) && parsed >= 0 ? parsed : fallback;\n};\n\nconst safeFloat = (value: string) => {\n  const parsed = Number.parseFloat(value);\n  return Number.isFinite(parsed) && parsed >= 0 ? parsed : 0;\n};\n\nexport const parseGroupsForm = (input?: string): GroupSpec[] => {\n  if (!input) return [DEFAULT_GROUP];\n\n  return input\n    .split(GROUP_SEPARATOR)\n    .map((segment) => segment.trim())\n    .filter(Boolean)\n    .map((segment) => {\n      const [roomsRaw, rest] = segment.split(':');\n      const [adultsRaw, childrenRaw = '0', infantsRaw = '0'] = (rest ?? '').split(',');\n      const childrenAges = childrenRaw\n        .split(CHILD_SEPARATOR)\n        .map((age) => age.trim())\n        .filter(Boolean)\n        .map((age) => safeFloat(age))\n        .filter((age) => age >= 0);\n\n      return {\n        rooms: Math.max(1, safeInt(roomsRaw, 1)),\n        adults: Math.max(1, safeInt(adultsRaw, 1)),\n        childrenAges,\n        infants: Math.max(0, safeInt(infantsRaw, 0)),\n      } satisfies GroupSpec;\n    });\n};\n\nexport const formatGroupsForm = (groups: GroupSpec[]): string =>\n  groups\n    .map((group) => {\n      const children = group.childrenAges.length\n        ? group.childrenAges.map((age) => age.toString()).join(CHILD_SEPARATOR)\n        : '0';\n      return `${group.rooms}:${group.adults},${children},${group.infants}`;\n    })\n    .join(GROUP_SEPARATOR);\n\nexport const summarizeGuests = (groups: GroupSpec[]) => {\n  const summary = groups.reduce(\n    (acc, group) => {\n      acc.rooms += group.rooms;\n      acc.adults += group.adults;\n      acc.children += group.childrenAges.length;\n      acc.infants += group.infants;\n      return acc;\n    },\n    { rooms: 0, adults: 0, children: 0, infants: 0 }\n  );\n  return summary;\n};\n\nexport const cloneGroups = (groups: GroupSpec[]): GroupSpec[] =>\n  groups.map((group) => ({ ...group, childrenAges: [...group.childrenAges] }));\n","import {\n  WidgetConfig,\n  WidgetState,\n  ValidationResult,\n  SearchRequest,\n  GroupSpec,\n  WidgetEvent,\n  WidgetEventType,\n} from './types';\nimport { cloneGroups, DEFAULT_GROUP, formatGroupsForm, parseGroupsForm } from './format';\n\nconst ISO_DATE_PATTERN = /\\d{4}-\\d{2}-\\d{2}/;\n\nconst todayIso = () => {\n  const now = new Date();\n  now.setHours(0, 0, 0, 0);\n  return now.toISOString().slice(0, 10);\n};\n\nconst addDays = (iso: string, days: number) => {\n  const date = new Date(iso);\n  date.setDate(date.getDate() + days);\n  return date.toISOString().slice(0, 10);\n};\n\nconst ensureIsoDate = (value: string | undefined, fallback: string) =>\n  value && ISO_DATE_PATTERN.test(value) ? value : fallback;\n\nconst DEFAULT_LOCALE = 'en';\nconst DEFAULT_CURRENCY = 'USD';\nconst DEFAULT_POS = 'GLOBAL';\nconst DEFAULT_PRODUCT_ID = 1000;\n\nexport const createInitialState = (config: WidgetConfig): WidgetState => {\n  const baseStart = ensureIsoDate(config.initialStart, todayIso());\n  const baseEnd = ensureIsoDate(config.initialEnd, addDays(baseStart, 1));\n\n  const startDate = baseStart;\n  let endDate = baseEnd;\n  if (endDate <= startDate) {\n    endDate = addDays(startDate, 1);\n  }\n\n  const parsedGroups = parseGroupsForm(config.initialGroups);\n  const groups = parsedGroups.length ? parsedGroups : [DEFAULT_GROUP];\n\n  return {\n    startDate,\n    endDate,\n    pos: config.pos ?? DEFAULT_POS,\n    locale: config.locale ?? DEFAULT_LOCALE,\n    currency: config.currency ?? DEFAULT_CURRENCY,\n    productId: config.productId ?? DEFAULT_PRODUCT_ID,\n    groups: cloneGroups(groups),\n    redirect: Boolean(config.redirect),\n    isSearching: false,\n    errors: {},\n  };\n};\n\nconst validateDateRange = (start: string, end: string) => {\n  if (!ISO_DATE_PATTERN.test(start)) return 'Start date is invalid.';\n  if (!ISO_DATE_PATTERN.test(end)) return 'End date is invalid.';\n  if (end <= start) return 'End date must be after start date.';\n  return null;\n};\n\nconst validateGroups = (groups: GroupSpec[]) => {\n  if (!groups.length) return 'At least one room group is required.';\n  for (const [index, group] of groups.entries()) {\n    if (group.rooms <= 0) return `Room ${index + 1}: rooms must be greater than 0.`;\n    if (group.adults <= 0) return `Room ${index + 1}: adults must be greater than 0.`;\n    if (group.childrenAges.some((age) => age < 0)) {\n      return `Room ${index + 1}: child ages must be >= 0.`;\n    }\n    if (group.infants < 0) return `Room ${index + 1}: infants must be >= 0.`;\n  }\n  return null;\n};\n\nexport const validateState = (state: WidgetState): ValidationResult => {\n  const errors: ValidationResult['errors'] = {};\n\n  const dateError = validateDateRange(state.startDate, state.endDate);\n  if (dateError) errors.dates = dateError;\n\n  if (!state.productId || state.productId <= 0) {\n    errors.productId = 'Product is required.';\n  }\n\n  const groupError = validateGroups(state.groups);\n  if (groupError) errors.groups = groupError;\n\n  if (!state.pos) errors.pos = 'POS is required.';\n  if (!state.locale) errors.locale = 'Language is required.';\n  if (!state.currency) errors.currency = 'Currency is required.';\n\n  return {\n    valid: Object.keys(errors).length === 0,\n    errors,\n  };\n};\n\nexport const buildSearchPayload = (\n  state: WidgetState,\n  config: WidgetConfig\n): SearchRequest => {\n  const groups_form = formatGroupsForm(state.groups);\n  return {\n    start_date: state.startDate,\n    end_date: state.endDate,\n    product_id: state.productId,\n    groups_form,\n    pos: state.pos,\n    language: state.locale,\n    currency: state.currency,\n    redirect: state.redirect ?? config.redirect ?? false,\n  };\n};\n\nexport const emit = (emitter: WidgetConfig['onEvent'] | undefined, event: WidgetEvent) => {\n  if (emitter) emitter(event);\n};\n\nexport const forwardEvent = (\n  emitter: WidgetConfig['onEvent'] | undefined,\n  type: WidgetEventType,\n  payload?: unknown\n) => emit(emitter, { type, payload });\n","import {\n  WidgetConfig,\n  WidgetEvent,\n  WidgetEventType,\n  WidgetState,\n  GroupSpec,\n  SearchResponse,\n} from './core/types';\nimport { cloneGroups, formatGroupsForm, summarizeGuests } from './core/format';\nimport { buildSearchPayload, createInitialState, validateState } from './core/state';\n\nconst STYLE_TEXT = `\n:host {\n  all: initial;\n  display: inline-block;\n  font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n}\n.yw-container {\n  font-family: inherit;\n  background: var(--yw-bg, #ffffff);\n  color: var(--yw-fg, #101828);\n  border: 1px solid rgba(16, 24, 40, 0.1);\n  border-radius: 12px;\n  padding: 1rem;\n  min-width: 260px;\n  max-width: 420px;\n  box-sizing: border-box;\n  box-shadow: 0 8px 24px rgba(16, 24, 40, 0.08);\n}\n.yw-container[data-theme='dark'] {\n  background: var(--yw-bg, #101828);\n  color: var(--yw-fg, #ffffff);\n  border-color: rgba(255, 255, 255, 0.2);\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.75);\n}\n.yw-container h2 {\n  font-size: 1.1rem;\n  margin: 0 0 0.75rem;\n}\nform {\n  display: grid;\n  gap: 0.75rem;\n}\nlabel {\n  display: flex;\n  flex-direction: column;\n  font-size: 0.85rem;\n  gap: 0.35rem;\n}\ninput,\nselect,\nbutton {\n  font: inherit;\n}\ninput,\nselect {\n  border-radius: 8px;\n  border: 1px solid rgba(16, 24, 40, 0.18);\n  padding: 0.5rem 0.6rem;\n  background: var(--yw-bg, #ffffff);\n  color: inherit;\n}\n[data-theme='dark'] input,\n[data-theme='dark'] select {\n  border-color: rgba(255, 255, 255, 0.18);\n}\n.yw-row {\n  display: grid;\n  gap: 0.75rem;\n}\n.yw-row--inline {\n  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));\n}\n.yw-groups {\n  display: grid;\n  gap: 0.75rem;\n  border: 1px dashed rgba(16, 24, 40, 0.15);\n  padding: 0.75rem;\n  border-radius: 8px;\n}\n.yw-group {\n  display: grid;\n  gap: 0.5rem;\n}\n.yw-group-controls {\n  display: flex;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n}\n.yw-group-controls label {\n  flex: 1;\n  min-width: 120px;\n}\n.yw-actions {\n  display: flex;\n  justify-content: space-between;\n  gap: 0.75rem;\n  align-items: center;\n}\n.yw-primary {\n  background: var(--yw-accent, #2563eb);\n  border: none;\n  color: #ffffff;\n  border-radius: 999px;\n  padding: 0.65rem 1.25rem;\n  cursor: pointer;\n  transition: transform 0.15s ease, box-shadow 0.2s ease;\n}\n.yw-primary:disabled {\n  opacity: 0.55;\n  cursor: not-allowed;\n}\n.yw-secondary {\n  background: transparent;\n  border: 1px solid rgba(16, 24, 40, 0.2);\n  color: inherit;\n  border-radius: 999px;\n  padding: 0.55rem 1rem;\n  cursor: pointer;\n}\n.yw-error {\n  color: #dc2626;\n  font-size: 0.8rem;\n}\n[data-theme='dark'] .yw-error {\n  color: #f87171;\n}\n.yw-summary {\n  font-size: 0.85rem;\n  opacity: 0.8;\n}\nsmall {\n  font-size: 0.8rem;\n  opacity: 0.7;\n}\n`;\n\nconst observed = [\n  'token',\n  'theme',\n  'locale',\n  'currency',\n  'pos',\n  'product-id',\n  'initial-start',\n  'initial-end',\n  'initial-groups',\n  'redirect',\n];\n\ntype AttributeName = (typeof observed)[number];\n\nconst booleanAttr = (host: HTMLElement, name: AttributeName): boolean | undefined => {\n  if (!host.hasAttribute(name)) return undefined;\n  const value = host.getAttribute(name);\n  if (value === null || value === '' || value.toLowerCase() === 'true') return true;\n  if (value.toLowerCase() === 'false') return false;\n  return true;\n};\n\nconst toNumber = (value: string | null | undefined) => {\n  if (value == null) return undefined;\n  const parsed = Number(value);\n  return Number.isFinite(parsed) ? parsed : undefined;\n};\n\nconst mapGroupToMarkup = (group: GroupSpec, index: number) => `\n  <div class=\"yw-group\" data-index=\"${index}\">\n    <header class=\"yw-summary\">Room ${index + 1}</header>\n    <div class=\"yw-group-controls\">\n      <label>\n        <span>Rooms</span>\n        <input type=\"number\" min=\"1\" data-group-field=\"rooms\" data-index=\"${index}\" value=\"${group.rooms}\" />\n      </label>\n      <label>\n        <span>Adults</span>\n        <input type=\"number\" min=\"1\" data-group-field=\"adults\" data-index=\"${index}\" value=\"${group.adults}\" />\n      </label>\n      <label>\n        <span>Children ages</span>\n        <input type=\"text\" placeholder=\"e.g. 5.8\" data-group-field=\"children\" data-index=\"${index}\" value=\"${\n          group.childrenAges.join('.')\n        }\" />\n      </label>\n      <label>\n        <span>Infants</span>\n        <input type=\"number\" min=\"0\" data-group-field=\"infants\" data-index=\"${index}\" value=\"${group.infants}\" />\n      </label>\n    </div>\n    ${index > 0\n      ? `<button class=\"yw-secondary\" type=\"button\" data-remove-group=\"${index}\" aria-label=\"Remove room ${index + 1}\">Remove room</button>`\n      : ''}\n  </div>\n`;\n\nconst renderGroups = (groups: GroupSpec[]) => groups.map(mapGroupToMarkup).join('');\n\nconst parseChildren = (value: string) =>\n  value\n    .split(/[.,]/)\n    .map((age) => age.trim())\n    .filter(Boolean)\n    .map(Number)\n    .filter((age) => Number.isFinite(age) && age >= 0);\n\nconst defaultConfig = (token: string): WidgetConfig => ({ token });\n\nexport class YourWidgetElement extends HTMLElement {\n  private state: WidgetState;\n  private config: WidgetConfig;\n  private bootstrapped = false;\n\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this.config = defaultConfig(this.getAttribute('token') ?? 'PUBLIC_TOKEN');\n    this.state = createInitialState({ ...this.config, initialGroups: this.getAttribute('initial-groups') ?? undefined });\n  }\n\n  static get observedAttributes() {\n    return observed;\n  }\n\n  connectedCallback() {\n    this.config = this.readConfig();\n    this.state = createInitialState(this.config);\n    this.render();\n    this.bootstrapped = true;\n    this.emit('ready', { state: this.state });\n  }\n\n  attributeChangedCallback() {\n    if (!this.bootstrapped) return;\n    this.config = this.readConfig();\n    this.state = createInitialState(this.config);\n    this.render();\n  }\n\n  private readConfig(): WidgetConfig {\n    return {\n      token: this.getAttribute('token') ?? 'PUBLIC_TOKEN',\n      theme: (this.getAttribute('theme') as WidgetConfig['theme']) ?? undefined,\n      locale: this.getAttribute('locale') ?? undefined,\n      currency: this.getAttribute('currency') ?? undefined,\n      pos: this.getAttribute('pos') ?? undefined,\n      productId: toNumber(this.getAttribute('product-id')),\n      initialStart: this.getAttribute('initial-start') ?? undefined,\n      initialEnd: this.getAttribute('initial-end') ?? undefined,\n      initialGroups: this.getAttribute('initial-groups') ?? undefined,\n      redirect: booleanAttr(this, 'redirect'),\n      onEvent: (event) => this.emit(event.type, event.payload),\n    };\n  }\n\n  private emit(type: WidgetEventType, payload?: unknown) {\n    const detail: WidgetEvent = { type, payload };\n    this.dispatchEvent(new CustomEvent('yw:event', { detail, bubbles: true, composed: true }));\n  }\n\n  private setState(next: Partial<WidgetState>) {\n    this.state = { ...this.state, ...next };\n    this.emit('change', { state: this.state });\n    this.render();\n  }\n\n  private render() {\n    if (!this.shadowRoot) return;\n    const theme = this.config.theme ?? 'light';\n    const { startDate, endDate, pos, locale, currency, productId, groups, isSearching, errors, redirect } = this.state;\n    const summary = summarizeGuests(groups);\n    const errorMessage = Object.values(errors)[0] ?? '';\n\n    this.shadowRoot.innerHTML = `\n      <style>${STYLE_TEXT}</style>\n      <div class=\"yw-container\" data-theme=\"${theme}\" role=\"region\" aria-live=\"polite\">\n        <h2>Booking search</h2>\n        <form>\n          <div class=\"yw-row yw-row--inline\">\n            <label>\n              <span>Check-in</span>\n              <input type=\"date\" name=\"start\" value=\"${startDate}\" />\n            </label>\n            <label>\n              <span>Check-out</span>\n              <input type=\"date\" name=\"end\" value=\"${endDate}\" min=\"${startDate}\" />\n            </label>\n          </div>\n\n          <div class=\"yw-row yw-row--inline\">\n            <label>\n              <span>POS</span>\n              <input type=\"text\" name=\"pos\" value=\"${pos}\" />\n            </label>\n            <label>\n              <span>Language</span>\n              <input type=\"text\" name=\"locale\" value=\"${locale}\" />\n            </label>\n            <label>\n              <span>Currency</span>\n              <input type=\"text\" name=\"currency\" value=\"${currency}\" />\n            </label>\n          </div>\n\n          <label>\n            <span>Product ID</span>\n            <input type=\"number\" name=\"product\" min=\"1\" value=\"${productId}\" />\n          </label>\n\n          <section class=\"yw-groups\" aria-label=\"Guests\">\n            ${renderGroups(groups)}\n            <button type=\"button\" class=\"yw-secondary\" data-add-group>Add room</button>\n            <p class=\"yw-summary\">${summary.rooms} rooms · ${summary.adults} adults · ${summary.children} children · ${summary.infants} infants</p>\n          </section>\n\n          <label>\n            <span>\n              Redirect to booking engine\n              <input type=\"checkbox\" name=\"redirect\" ${redirect ? 'checked' : ''} />\n            </span>\n          </label>\n\n          ${errorMessage ? `<p class=\"yw-error\">${errorMessage}</p>` : ''}\n\n          <div class=\"yw-actions\">\n            <button type=\"submit\" class=\"yw-primary\" ${isSearching ? 'disabled' : ''}>${\n      isSearching ? 'Searching…' : 'Search'\n    }</button>\n            <small>${formatGroupsForm(groups)}</small>\n          </div>\n        </form>\n      </div>\n    `;\n\n    this.bindEvents();\n  }\n\n  private bindEvents() {\n    const root = this.shadowRoot;\n    if (!root) return;\n\n    const form = root.querySelector('form');\n    form?.addEventListener('submit', (event) => this.onSubmit(event));\n\n    const registerInput = (selector: string, handler: (value: string) => void) => {\n      const input = root.querySelector<HTMLInputElement>(selector);\n      if (!input) return;\n      input.addEventListener('change', (event) => handler((event.target as HTMLInputElement).value));\n    };\n\n    registerInput('input[name=\"start\"]', (value) => this.setState({ startDate: value }));\n    registerInput('input[name=\"end\"]', (value) => this.setState({ endDate: value }));\n    registerInput('input[name=\"pos\"]', (value) => this.setState({ pos: value }));\n    registerInput('input[name=\"locale\"]', (value) => this.setState({ locale: value }));\n    registerInput('input[name=\"currency\"]', (value) => this.setState({ currency: value }));\n    registerInput('input[name=\"product\"]', (value) => this.setState({ productId: Number(value) || 0 }));\n\n    const redirectInput = root.querySelector<HTMLInputElement>('input[name=\"redirect\"]');\n    redirectInput?.addEventListener('change', (event) => {\n      const target = event.target as HTMLInputElement;\n      this.setState({ redirect: target.checked });\n    });\n\n    root.querySelectorAll<HTMLInputElement>('[data-group-field]').forEach((input) => {\n      input.addEventListener('change', (event) => {\n        const target = event.target as HTMLInputElement;\n        const index = Number(target.dataset.index ?? '0');\n        const field = target.dataset.groupField;\n        this.updateGroup(index, field ?? '', target.value);\n      });\n    });\n\n    root.querySelectorAll<HTMLButtonElement>('[data-remove-group]').forEach((button) => {\n      button.addEventListener('click', () => {\n        const index = Number(button.dataset.removeGroup ?? '0');\n        this.setState({ groups: this.state.groups.filter((_, idx) => idx !== index) });\n      });\n    });\n\n    const addButton = root.querySelector<HTMLButtonElement>('[data-add-group]');\n    addButton?.addEventListener('click', () => {\n      this.setState({ groups: [...cloneGroups(this.state.groups), { rooms: 1, adults: 2, childrenAges: [], infants: 0 }] });\n    });\n  }\n\n  private updateGroup(index: number, field: string, value: string) {\n    const groups = cloneGroups(this.state.groups);\n    const target = groups[index];\n    if (!target) return;\n\n    if (field === 'rooms') target.rooms = Math.max(1, Number(value) || 1);\n    if (field === 'adults') target.adults = Math.max(1, Number(value) || 1);\n    if (field === 'children') target.childrenAges = parseChildren(value);\n    if (field === 'infants') target.infants = Math.max(0, Number(value) || 0);\n\n    this.setState({ groups });\n  }\n\n  private async onSubmit(event: Event) {\n    event.preventDefault();\n    const validation = validateState(this.state);\n    if (!validation.valid) {\n      this.setState({ errors: validation.errors });\n      this.emit('validate_error', validation);\n      return;\n    }\n\n    const payload = buildSearchPayload({ ...this.state, errors: {} }, this.config);\n    this.setState({ isSearching: true, errors: {} });\n    this.emit('search_start', payload);\n\n    try {\n      const response = await fetch('https://gateway-prod.pxsol.com/v2/search', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${this.config.token}`,\n        },\n        body: JSON.stringify(payload),\n      });\n\n      if (!response.ok) {\n        throw new Error(`Search failed with status ${response.status}`);\n      }\n\n      const data = (await response.json()) as SearchResponse;\n      this.setState({ isSearching: false, lastResponse: data });\n      this.emit('search_success', { request: payload, response: data });\n\n      if (payload.redirect && data.booking_engine_url) {\n        window.location.assign(data.booking_engine_url);\n      }\n    } catch (error) {\n      const err = error instanceof Error ? error : new Error('Unexpected error');\n      this.setState({ isSearching: false });\n      this.emit('search_error', { request: payload, error: err });\n      console.error('[booking-search-widget]', err);\n    }\n  }\n}\n\nif (!customElements.get('your-widget')) {\n  customElements.define('your-widget', YourWidgetElement);\n}\n\nexport const registerYourWidget = () => {\n  if (!customElements.get('your-widget')) {\n    customElements.define('your-widget', YourWidgetElement);\n  }\n};\n"]}